530 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS—I: REGULAR PAPERS, VOL. 57, NO. 3, MARCH 2010
Systematic Design of a Transimpedance Ampliﬁer
With Speciﬁed Electromagnetic Out-of-Band
Interference Behavior
Marcel J. van der Horst, André C. Linnenbank , Member , IEEE , Wouter A. Serdijn , Senior Member , IEEE , and
John R. Long , Member , IEEE
Abstract— In negative-feedback ampliﬁer design, electro-
magnetic interference (EMI) behavior is usually completelydisregarded. EMI can, e.g., result in detection of low-frequencyenvelope variations of the usually high-frequency interferingsignals. If the detected signals end up in the pass band of thenegative-feedback ampliﬁer, they cannot be distinguished fromthe intended signal any longer, so the signal-to-error ratio (SER)is reduced. Several measures can be taken to prevent unaccept-able reduction of the SER, like applying ﬁlters, chokes, etc. Inthis paper, however, circuit design aspects are investigated. It isassumed that interference reaches the ampliﬁer input and that theSER has to be assured by a proper design of the negative-feedbackampliﬁer. Since EMI is related to nonlinear distortion, it is afunction of the loop gain of the negative-feedback ampliﬁer. Fora given electromagnetic (EM) environment it is therefore possibleto calculate the minimum loop gain required to reduce EMI to
acceptable levels without ﬁltering. To illustrate this systematic
design method a transimpedance ampliﬁer is designed and builtto properly function in interfering ﬁeld strengths up to 30 V/m.Experimental results are in good agreement with theory.
Index Terms— Envelope detection, electromagnetic interference
(EMI ), negative-feedback ampliﬁer, nonlinear distortion, signal-to-
error ratio (SER), susceptibility, transimpedance ampliﬁer.
I. I NTRODUCTION
DESIGNING a negative-feedback ampliﬁer usually starts
with determining the speciﬁcations of the ampliﬁer to be
designed. Electromagnetic compatibility (EMC) is a require-ment that is often disregarded in the design process. Yet, with thecurrent congestion of the electromagnetic (EM) spectrum due toelectronic systems that intentionally, or unintentionally, pollutethe EM environment, the interference burden for negative-feed-back ampliﬁers increases. In order not to degrade the ampliﬁerperformance due to electromagnetic interference (EMI), EMCshould be considered and incorporated in the design process.
Manuscript received July 08, 2008; revised November 06, 2008, March 12,
2009. First published June 10, 2009; current version published March 05, 2010.
This paper was recommended by Associate Editor A. J. Lopez Martin.
M. J. van der Horst is with the Department of Electrical Engineering,
Hogeschool van Amsterdam, Amsterdam 1000 BA, The Netherlands (e-mail:
m.j.van.der.horst@hva.nl).
A. C. Linnenbank is with the Heart Failure Research Center, Academic Med-
ical Center, University of Amsterdam, Amsterdam 1105 AZ, The Netherlands(e-mail: a.c.linnenbank@amc.uva.nl).
W. A. Serdijn and J. R. Long are with the Electronics Research Labora-
tory/DIMES, Delft University of Technology, Delft 2628 CD, The Netherlands
(e-mail: w.a.serdijn@tudelft.nl; resp.j.r.long@tudelft.nl).
Digital Object Identiﬁer 10.1109/TCSI.2009.2025003In practical situations, the negative-feedback ampliﬁer itself
seldomly is a severe source of interference, but its susceptibilitymay be large. Therefore, this paper concentrates on reducingthe ampliﬁer susceptibility to an acceptable level. Here, EMIinduced errors, by out-of-band interference, comparable to the
total white noise generated by the ampliﬁer are considered to be
acceptable.
Usually, EMI is prevented by screening of wires, using
chokes and applying ﬁlters reducing the disturbing out-of-bandsignal at the input of the ampliﬁer. Here, as an additional, al-ternative, measure, it is investigated how the negative-feedbackampliﬁer itself can be designed to have a low EMI susceptibilityto the unﬁltered out-of-band disturbing signal at its input, byusing circuit design strategies only.
The effects of EMI on active devices like bipolar junction
transistors (BJT) or FETs are closely related to second-orderharmonic distortion, i.e., it is determined by the second-ordernonlinearity of the device [1]. Disturbance results in dc-shifts ofthe bias currents and detection of the envelope of the disturbingsignal. Although slight shifts in biasing may be tolerated in some
cases, envelope detection may result in signals within the am-
pliﬁer bandwidth that cannot be distinguished from the intendedsignals. This adversely affects the ﬁdelity of the intended signaltransfer, and thus the signal-to-error ratio (SER). The adverseeffect on the SER due to envelope detection is meant when theterm EMI is used in the remainder of this paper. Note that bothnoise and EMI determine the total SER.
Methods to model and analyze distortion and EMI in BJTs,
FETs, negative-feedback ampliﬁers, and also some designsof low EMI susceptible opamps have been published, e.g.,[2]–[13]. A simple, systematic method to design an applica-tion speciﬁc negative-feedback ampliﬁer with speciﬁed SER,output-, and bandwidth requirements has not been presented asyet.
Since EMI is related to nonlinear distortion, it is a function
of the loop gain of the negative-feedback ampliﬁer [11]. For a
given EM environment and active device, it is therefore possibleto calculate the minimum loop gain required to reduce EMI toacceptable levels without ﬁltering. This is demonstrated by sys-tematically designing a transimpedance ampliﬁer for a speciﬁcEM environment. Section II presents the design speciﬁcations,including the minimally allowed SER.
In order to ensure a particular SER, the amount of disturbance
the electromagnetic ﬁeld generates has to be determined. There-fore, a simple method for approximating the disturbance will bepresented in Section III.
1549-8328/$26.00 © 2010 IEEE
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. V AN DER HORST et al. : SYSTEMATIC DESIGN OF A TIA WITH SPECIFIED ELECTROMAGNETIC OUT-OF-BAND INTERFERENCE BEHA VIOR 531
TABLE I
SPECIFICATIONS
Preliminary computations showed that the bandwidth spec-
iﬁcations could not be met with a single BJT stage due to theMiller effect. Cascode stages neutralize the adverse effect ofthe base–collector or gate–drain capacitance and the Miller ef-fect does not occur. A hybrid-
model valid for both linear and
second-order nonlinearity analysis of a BJT–BJT cascode stageis shown in Section IV. With the necessary changes, it can alsobe used to model these effects in cascode stages consisting ofother combinations of active devices.
Section V demonstrates the design of a transimpedance am-
pliﬁer that meets all speciﬁcations, with this BJT–BJT cascodeas active part. Susceptibility measurements on the realized tran-
simpedance ampliﬁer are presented in Section VI, and are in
close agreement with theory. Section VII presents a short dis-cussion. Finally, Section VIII presents the concluding remarks.
II. S
PECIFICATIONS
The method to design a transimpedance ampliﬁer with a spec-
iﬁed SER in high ﬁeld strengths is demonstrated by designingsuch an ampliﬁer for a given signal source and load. Table I sum-marizes the speciﬁcations of the source, load, signal transfer,and EM environment, respectively. All speciﬁcations chosen arerealistic and may occur in practice.
The envelope of the plane waves shows low-frequency
variations that are in the ampliﬁers’ pass band. The maximumvariation in the envelope corresponds to an amplitude modula-tion with a modulation index of 1, as stated in Table I. Such anEM environment may very well occur in practice. Industrial,scientiﬁc, and medical equipment (ISM), e.g., used for heating,diathermy, or electrosurgery, but also radio transmitters, mayradiate EM ﬁelds with high ﬁeld strengths and low-frequencyenvelope variations. In some ISM bands (13.5, 27.0, and
40.7 MHz), the amount of power that may be radiated is even
unrestricted in some countries [14]. EM-ﬁeld strength levelsbetween 10 and 30 V/m can readily occur in the vicinity ofthese radiating equipment. Therefore, equipment in an indus-trial environment and life-supporting medical systems shouldbe immune to EM ﬁelds up to at least 10 V/m [14], [15].
The consequences of a too large susceptibility in a harsh EM
environment, i.e., a too low SER, of the negative-feedback am-pliﬁer (as part of a lager system) may vary from life-threateningsituations in medical environments [16], [17] and in aviation,to inconvenience when telephones can be used to listen to AMradio broadcasts [1]. Maintaining a high enough SER in highEM-ﬁeld strength levels is thus important, especially in possiblelife-threatening situations. Here, a minimal SER equal to 70 dB
is expected to prevent these detrimental effects.
The relatively low upper frequency of 100 MHz to design for,
has been speciﬁcally chosen. This relieves the measurement dif-ﬁculties that can be expected at higher frequencies where board
lay-out properties do play a signiﬁcant role. The method pre-
sented in this work is, nonetheless, also applicable to muchhigher frequencies in the GHz range such as used by cellularphones.
We will assume that both the negative-feedback ampliﬁer and
the load are shielded from interfering ﬁelds, but the interconnectbetween source and ampliﬁer will not be shielded. To ease thecalculation of EM coupling, the interconnect is assumed to con-sist of two wires that have a ﬁxed distance to each other, com-parable with two wires of ribbon cable, and that EM interactionwith the shield does not occur. We will use a so called two-wireline [18] with a length of 0.1 m, a distance between the wires of1.27 mm, an inductance of 92.7 nH, and a measured capacitanceof 2.36 pF.
The intended signal is smallest at the input of the ampliﬁer,
this is thus the place where noise and EMI have the largest detri-
mental effect. Both noise and EMI effects are therefore trans-ferred to an equivalent source at the input of the ampliﬁer.
If it is assumed that the equivalent noise power and equivalent
EMI power are uncorrelated, the SER is simply the ratio of thesignal power and the sum of both.
III. D
ETERMINING THE DISTURBING CURRENT
Using transmission line equations and by integrating the total
ﬁeld along the two-wire, voltages and currents at the termi-nals of the wire can be determined accurately [19]. These volt-
ages and currents can also be determined for other types of
interconnects, e.g., microstrip lines, with this generally validmethod. For the speciﬁed frequency range, the two-wire is elec-trically short. Its electrical behavior may be described by meansof lumped-circuit models instead of using the transmission lineequations, while the induced voltage and current can be mod-eled by a current source in parallel with the admittances and avoltage source in series with the impedances respectively, e.g.,[18].
The magnitude of the disturbing current at the input of current
processing ampliﬁers, can easily be determined by assuming theinput impedance of the ampliﬁer,
, to be zero.
The practical transimpedance ampliﬁer will not have a zero
input impedance. To simplify the design process, an ideal ampli-ﬁer can be considered nevertheless. Deviations in the calculated
disturbing signal, due to deviations of
from the ideal value,
presented to the input of the ampliﬁer can be evaluated later. Ifthe practical transimpedance ampliﬁer is designed properly, theconstraint for the source impedance
still holds. The
deviations between the “ideal” and “practical” values of the dis-turbing signal are thus expected to be small.
Under the speciﬁed conditions, the disturbing current at the
input of the transimpedance ampliﬁer can now be approximatedby
[18], where
 is the angular fre-
quency,
 is the capacitance of the two-wire,
 the distance
between the conductors,
 is the electric ﬁeld strength,
 is the
angle between the E-ﬁeld and the two-wire, and
 .
When the orientation of the E-ﬁeld is perpendicular to the two-
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. 532 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS—I: REGULAR PAPERS, VOL. 57, NO. 3, MARCH 2010
Fig. 1. Total disturbing current at the input of the transimpedance ampliﬁer
as a function of frequency calculated with a lumped-circuit model (solid line)
and as predicted by transmission line theory (dashed line). At a frequency of
about 240 MHz, the lumped-circuit model becomes less accurate because the
two-wire is not electrically short anymore. Resonance and antiresonance pointscan be identiﬁed in the transmission line model based
/105
 calculation that
do not occur in the simple model. The lumped-circuit model completely looses
validity at approximately 1 GHz.
wire
 is maximal. Note that for frequencies
higher than 100 MHz, the contributions of the magnetic ﬁeldcomponent and inductance
have to be taken into account as
well.
In EMC engineering, it is customary to assume the worst case
scenario, i.e., maximal ﬁeld coupling. This also makes sensefrom a design point of view; therefore, in this paper, maximal
is assumed
 .
To demonstrate the validity of the lumped-circuit model
for the speciﬁed maximum frequency of the interfering planewaves, Fig. 1 shows both the graph of
determined by
the lumped-circuit model, including the magnetic ﬁeld com-ponent, [18] and determined by the transmission line method
[19]. Both graphs are in good agreement up to the frequency at
which the lumped-circuit model becomes less accurate (
MHz) because the two-wire is not electrically short anymore.When designing for low EMI for frequencies higher than ap-proximately 1 GHz the transmission line method to determine
should be used.
IV . M ODIFIED CASCODE MODEL
A cascode stage consists of a cascade of two transistors, a
common-emitter (CE) and a common-base (CB) stage, wherethe CB stage is used to ensure a unilateral behavior of the CEstage.
The CB stage is a single-stage current ampliﬁer with a current
gain very close to one. Using the method presented in [11] it
can be concluded that the envelope detection of the CB stage is
negligible compared to that of the CE stage, even at frequencieshigher than transit frequency,
, of the CB stage, as long as the
loop gain around the CB stage is large. This large loop gain isusually easily obtained by assuring that
, and
 , where
 , and
 have
their usual meaning as used in the hybrid-
 model and
 is the
impedance that loads the output of the CB stage. The (linear)
Fig. 2. Modiﬁed hybrid- /25model of the BJT–BJT cascode, valid when /114
 /29
/114
 /59/114
 /29 /90
 /59/103
 /2 /114
 /29 /12
 , and valid for linear and second-
order nonlinear transfer analysis.
transconductance is denoted by
 and will be discussed in
more detail later.
The hybrid-
 model capable of describing both linear and
second-order nonlinear behavior of the cascode is shown inFig. 2. The cascode shows an input impedance formed by baseresistance
, base–emitter resistance
 , and base–emitter
capacitance
 of the CE stage. In parallel with
 there
is a capacitance
 (Miller
approximation).
 is the input admittance of the CB
stage and equals
 . For frequencies lower
than the pole in
 , which is approximately equal to
and for frequencies
higher than this pole its value reduces to
 . The
output is formed by a resistance,
 , approximately equal to
, shunted by a capacitance equal to
 .
At the input, a voltage controlled current source of value
represents the second-order nonlinearity of the base
current due to the nonlinear input conductance. Finally, at theoutput there is also a voltage controlled current source of value
that represents the linear and second-order
nonlinear term of the collector current due to the exponentialinput voltage to output current relation of the BJT.
,
and
 can be determined by a Taylor expansion in the BJT
operating point [2], [6], [7], [11].
The expressions for
 and
 are thus given by
in amperes per volt (1)
in amperes per volt squared (2)
where
 is the bias current,
 is Boltzmann’s constant,
 is
the absolute temperature in Kelvin,
 is the electron charge, and
is the forward emission coefﬁcient, usually close to 1.
In the so-called midcurrent region the current gain
 is vir-
tually constant, because secondary nonlinear effects due to bothlow (recombination in the base–emitter depletion layer) andhigh bias current (nonnegligible injection of minority carriersin the base) operation are negligible [20], [21]. The distortionbehavior of the BJT is minimal in this case.
A Taylor expansion of the nonlinear relation of the base cur-
rent and the base–emitter voltage in the midcurrent region re-sults in
in amperes per volt square
 (3)
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. V AN DER HORST et al. : SYSTEMATIC DESIGN OF A TIA WITH SPECIFIED ELECTROMAGNETIC OUT-OF-BAND INTERFERENCE BEHA VIOR 533
After some straightforward mathematical manipulation of the
Gummel–Poon equations [20], the lower and upper boundariesof the midcurrent region can be determined from
(4)
(5)
where
 is the saturation current,
 is the base–emitter leakage
coefﬁcient,
 is the forward current ampliﬁcation factor,
 is
base–emitter leakage current, and
 is the forward current
value where the current gain drops to half its value [20]. Coefﬁ-cient
presents a boundary value for the maximal contribution
of the base–emitter leakage current to the base current, whilecoefﬁcient
presents the maximal contribution of
 to the
collector current. Values of
 and
 usually result
in negligible secondary nonlinear effects and therefore seem tobe reasonable. The results of (4) and (5) can be used to easilyobtain the boundary values of
.
Truncating a Taylor expansion after the second term intro-
duces inaccuracy. However, for values of signal voltage
 up
to 10 mV the inaccuracy of the resulting signal current
 is
smaller than 1% [11].
 depends on
 and is therefore also
nonlinear. The resulting nonlinear current
 is, however, pro-
portional to
 .
 represents the second-order non-
linear value of
 and
 is the low-frequency variation of the
envelope. Current
 is often negligibly small compared to the
currents at
 due to
 , respectively,
 .
 may therefore be
regarded as being constant.
 is a constant because its value
is determined by a junction capacitance which is only slightlydependent on
. The junction capacitance
 may have
considerable signal voltage across it, modulating its capacitancevalue. It is, however, usually loaded by the input impedance of asubsequent stage or load, that is much smaller than
,
making its (nonlinear) effect negligible.
In properly designed negative-feedback ampliﬁers
 will be
most probably below 10 mV. Therefore, the modiﬁed hybrid-
model of Fig. 2 can be used to analyze linear and second-ordernonlinear, EMI, behavior.
The combined action of the voltage controlled current sources
tend to reduce the second-order nonlinear behavior. This lin-earizing action is especially effective when signal source resis-tance
is much larger than
 [3], see Section V, (13).
V. D ESIGN METHOD
The design of an application-speciﬁc negative-feedback am-
pliﬁer can be divided in several orthogonal steps [22]. From thesource and load speciﬁcations the required transfer and feed-back conﬁguration is determined ﬁrst. Second, the noise proper-ties are investigated, which result in optimal bias requirements.Third, the output requirements to the load are determined. Asfourth step, the required loop gain and
are determined to
meet the EMI speciﬁcation. The ﬁfth step is estimating the band-
width and applying frequency compensation to achieve a Butter-worth (maximally ﬂat) characteristic. Finally, as sixth step thebiasing arrangement is designed.From the source and load speciﬁcations (see Table I), it fol-
lows that the transimpedance should have a 100 k
value to
realize 1 V across the load for a source current of 10
 A. This
transimpedance can, e.g., be implemented by a negative-feed-back ampliﬁer with a feedback resistor of 100 k
.
Since noise will always be generated, thus also when there is
no interference, it will determine the maximal obtainable SERand is therefore considered before EMI. The maximal allowableEMI now follows from the required SER and the noise behavior.Noise and EMI are extensively dealt with in the next sections.
For elaborate treatment of the other steps we refer to [22].
They are only brieﬂy discussed here.
A. Noise
Under the assumption that the signal source generates noise
equivalent to the thermal noise of the real part of its admittance,for the transimpedance ampliﬁer with a bipolar input stage theequivalent input noise power is given by
(6)
In this equation,
 is the upper frequency of the bandwidth.
Because of the required large bandwidth of 1 MHz the inﬂuenceof the lower frequency corner of the bandwidth and the inﬂuenceof ﬂicker noise can be neglected, since for modern BJTs thefrequency at which the ﬂicker noise equals the white noise isusually a few Hz [22]. Further,
is the source resistance,
is formed by the source capacitance
 , and the capacitance of
the two-wire
 , in parallel.
 is the feedback resistor,
 is the
base resistance, and
 is the dc current gain of the transistor.
For low noise power, it immediately follows from (6) that a
BJT should be used having a high value of
 and, preferably,
a low value of
 . Also, (6) is valid under the assumption that
current noise contribution of the BJT is dominated by the basecurrent. This is allowed when
and
[22],
 being the transit frequency; conditions that usually can
be met easily.
B. Calculation of the Required Transconductance
When we design for equal contributions of both noise power
and EMI power to the SER, the most optimal design regardingthe SER results. After all, when a lot design effort is put in lownoise design while EMI dominates the SER, this effort is wasted.Similarly, design effort and power is wasted when EMI is de-signed to be much lower than the noise. Therefore, EMI shouldhave at most the same order of magnitude as the noise. From this
maximum EMI power, the minimal required transconductance
of the active part is determined.
The disturbing current generated by the nonconstant enve-
lope interfering EM ﬁeld, shows the same amplitude variations
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. 534 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS—I: REGULAR PAPERS, VOL. 57, NO. 3, MARCH 2010
Fig. 3. Hybrid- /25signal diagram of the transimpedance ampliﬁer.
as the EM ﬁeld. Like noise, the resulting envelope detection
(EMI) caused by the disturbing current can be represented byone equivalent current source at the input of the negative-feed-
back ampliﬁer. This source is given by [11]:
(7)
The angular frequency of the disturbing current is
 .
is the transfer from the disturbing current to the input of
the BJT, i.e., the transfer from
 to
 .
 is the
low-frequency term of the transfer from signal source
 to
and
 is the modulation depth. For a transimpedance
ampliﬁer
 also determines the transfer from source
to
 , when
 .
 is the second-order
nonlinearity term, which is a measure for the second-order
nonlinear behavior of the negative-feedback ampliﬁer. Here,
.
Fig. 3 depicts the hybrid-
 diagram of the transimpedance
ampliﬁer. Although the exact values of the circuit elements ofthe cascode are not yet known, using Table I some conclusionscan be drawn: load capacitance
will most probably be much
larger than
 and
 . There will be two poles
determining the bandwidth, with pole
 affected by
 and
located at a lower frequency than pole
 affected by the input
capacitance formed by
 , and
 shunted by
and
 . Expressions for the poles will be given later.
Transfer
 will have a zero located at approximately
the same frequency as
 , and therefore, shows a single pole
transfer [11]. The loop gain often shows two dominant poles
in case of application speciﬁc ampliﬁers.
 is given by the
ratio of
 and the loop gain and, when
 , it will
increase with increasing frequency up to some maximum valueat
after which it will decrease again [11], as Fig. 4 shows.
As a result,
 will show the same behavior.
Fig. 4 shows the transfer
 , current
 and
the resulting equivalent envelope detection source
in one ﬁgure. It shows how the slopes of
 depend
on
 and the slopes of
 . Between
 and
increases with a slope of 80 dB/dec and it sta-
bilizes at a constant value for frequencies higher than
 .
Further,
 will occur near the upper corner frequency of the
bandwidth
 given by the square root of the loop gain poles
product (LP). LP equals
 and
 is the loop
gain. Note that the ﬂat region of
 is due to out-of-band
disturbance and thus the region of interest.
Fig. 4. Transfers /106 /31 /106(solid line), /106 /105
 /106(dotted line), and /106 /105
 /106(dashed
line) as a function of frequency. The maximum frequency used in this ﬁgure is
in the “differentiating” region of /105
 . Note that the ﬂat region of /106 /105
 /106is
due to out-of-band disturbance and thus the region of interest.
Transfer
 is given by [11]
(8)
where
 is the zero-frequency value of the load that
current source
 experiences. Further, there is a term
that increases the damping factor
 ,g i v e n
by
 , with
 being
a phantom zero introduced by the designer to manipulate thepoles into the desired positions for the required frequency re-sponse of the source to load transfer, the transimpedance in thiscase.
is chosen to obtain a Butterworth transfer.
For values of
 smaller than
 overshoot will occur
at the upper edge of the bandwidth in both the source to loadtransfer and
. Proper frequency compensation thus reduces
EMI susceptibility near the upper edge of the bandwidth.
The maximum value of
 occurs at a frequency approxi-
mately equal to the upper limit of the bandwidth,
 . Using this
approximation and (8) (disregarding the phantom zero term forthe time being), the maximum value is derived to be
(9)
Still,
 and
 are unknown. To come to an equation that
can be solved, Fig. 3 has to be considered.
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. V AN DER HORST et al. : SYSTEMATIC DESIGN OF A TIA WITH SPECIFIED ELECTROMAGNETIC OUT-OF-BAND INTERFERENCE BEHA VIOR 535
Output resistance
 can be expected to have a value much
greater than
 and can therefore be neglected. For now, it is
assumed that
 can be neglected because it is much smaller
than
 . When this is not the case, its effect can be evaluated in
a later stadium. Feedback factor
 is determined from Fig. 3
and
 . With
 it follows for the loop
gain
(10)
Also, from Fig. 3 follows directly for
(11)
Equation (8) shows that
 when
 .
It is now possible to simplify this expression to a form where,apart from
, no hybrid-
 parameters appear.
(12)
Envelope variations usually occur at a low frequency. As an
approximation,
 in (7) can be used. For
 can now be
derived to hold
(13)
and
 . Note that
 may become small
when the BJT is current driven, i.e.,
 , and reaches
a maximal value of
 under voltage drive condition:
.
Combining the expression for
 , with the phantom zero dis-
regarded, (7), (9), (12), and (13) and solving for
 results in
(14)
The required transconductance can be calculated from this equa-
tion if one uses the desired bandwidth as the value for
 and a
ﬁrst-order approximation for
 and
 . This ﬁrst-order approx-
imation for
 follows from Fig. 3 by neglecting the inﬂuence of
, which is allowed because the shunt
 is in series with
the large-valued resistor
 , and is
. Under the condition that
 and
 are much larger
than
 and
 is larger than
 . Pole
 thus
follows from the transistor properties. As a ﬁrst-order approxi-mation of
, the maximal forward current gain
 , as speciﬁed
in Spice models, can be used.
C. Design of the BJT Transimpedance Ampliﬁer
To quickly realize a prototype transimpedance ampliﬁer, it
was chosen to design and build it using discrete BJTs. Fromthe large amount of BJTs that satisfy the design constraints, theBC548B, an npn transistor, was chosen.
1) Noise Calculation: From the noise equation derived ear-
lier (6), the optimal bias current for the transistor is determinedTABLE II
HYBRID - /25PARAMETERS , /73
 /61/49 /58 /51mA, /85
 /61/50 V
to be approximately 10
 A for the BC548B. The noise contri-
bution of the BJT is virtually negligible compared to the noisecontribution of
and
 . The resulting equivalent noise power
is
 . The resulting SNR is 84.5 dB, which
is the maximal obtainable SER.
2) Output Capability: In order to deliver a signal of 1 V
peak to the load, a current of 637
 A is required. When this
current has to be delivered to the load, one has to make sure thatenough current keeps ﬂowing through the output stage to avoidunacceptable decrease in transit frequency
. Biasing the output
stage at approximately 1.5 times the current to be delivered is agood strategy [22], resulting in a minimal bias current of 1 mA.
3) EMI: To be on the safe side, to compensate for component
spread and uncertainties in the exact value of
, the SER
to design for can be taken 73 dB, so there is a margin of 3 dB.With a
dB the total equivalent input error power
equals
 A
. If it is assumed that both
components equally contribute to the “error power”, a value for
of 1.58 nA is obtained.
It follows from
 that at
 the allowed
maximal value of
 is 567 nA. However, to be on the safe
side again, a bandwidth of 1.1 MHz is designed for. Using (14)with the corresponding
of 621 nA, it is now found that
should have a value of 48.5 mA/V , which corresponds to an
of 1.3 mA, to satisfy the EMI demands. This value of
 is
located in the midcurrent region. A
 of 294 and an
 of 628
M rad/s followed for the BC548B.
4) Discussion: The
 determined from the above EMI con-
siderations is only a little higher than required for the outputcapability. The power consumption thus does not excessivelyincrease. There is, however, a large discrepancy between thevalues of
for minimal noise performance and required for
EMI performance.
Biasing the cascode at a current of 1.3 mA instead of 10
 A
changes the noise behavior of the BJT. The contribution of theBJT to the equivalent noise power increases and will now beof the same order of magnitude as the noise from
and
 ,
which is still acceptable. The equivalent noise current power is
, resulting in a SER of 73.5 dB.
5) SER Analysis and Ampliﬁer Implementation: Biasing the
BJT cascode at a collector current
 of 1.3 mA and a col-
lector–emitter voltage of 2 V results in the values of the modi-
ﬁed hybrid-
 parameters tabulated in Table II. They were deter-
mined using Pspice to determine the linear values and (2) and (3)to determine the second-order values of the modiﬁed hybrid-
model. The simulated value of
 is slightly larger than the
value obtained with (1). This is because the calculated
 of
1.3 mA is a rounded up value.
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. 536 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS—I: REGULAR PAPERS, VOL. 57, NO. 3, MARCH 2010
Fig. 5. Schematic of the transimpedance ampliﬁer.
The loop gain is equal to
 , which results in an accuracy
of the transimpedance of 99.6 dB
 ; just 0.4 dB
 less than
in the ideal case. Poles
 and
 can be found at
rad/s, respectively,
 rad/s. The bandwidth
 ,
as predicted by the LP, is
 rad/s (1.29 MHz) and
. Note that the bandwidth speciﬁcations can not be
met with a noncascode single stage. Due to the Miller effect thebandwidth is in this case limited to approximately 460 kHz.
reaches a high value at approximately
 due to the low
value of
 . The minimal SER to be expected near
 amounts
70 dB, which is just within speciﬁcations. After frequency com-pensation to obtain a Butterworth characteristic, however, noovershoot will occur and therefore
will decrease, resulting
in a larger SER.
For a Butterworth characteristic a phantom zero [22] was in-
troduced by shunting
 with a capacitance
 of 1.18 pF.
Now, we have:
 and
 rad/s, which
is indeed very close to
 rad/s.
is determined to be 1211
 . This results in a corre-
sponding value of
 pA at
 . For frequencies just
above
 , the slope of
 (see Fig. 4) has not reached
dB/dec yet. This slope is reached after approximately an octave.In the frequency band
decreases about 3 dB
and
 increases 6 dB, resulting in an increase of 6 dB in
. As a result,
 pA for frequencies larger than
. The SER to be expected thus equals 76.1 dB.
The required SER is easily reached after frequency compen-
sation. The designer could consider to reduce the
 a little
in order to reduce power consumption. As a consequence
will increase and
 will decrease, but the required SER can
still be reached. A trade-off between power consumption andSER is thus possible. We will not elaborate on this here.
Fig. 5 shows the ﬁnal schematic of the designed tran-
simpedance ampliﬁer. A current source realized with a
BC556A pnp BJT biases the cascode at a collector currentof 1.3 mA. The resistors required for establishing the desired
base–emitter and collector–emitter voltages are chosen suchthat LP of the transimpedance is virtually not reduced. Spicesimulations show a transimpedance of 99.6 dB
, a bandwidth
of 1.29 MHz (
 rad/s) and an
 of 1.55 nA. These
ﬁgures are very close to the calculated values.
The effects of the nonzero input impedance of the tran-
simpedance ampliﬁer on
 can now be evaluated. As
stated before, the effect is expected to be minor; the inaccuracyof the ampliﬁer transfer function is just 0.4 dB
. Such a
low value of the inaccuracy implies an input impedance muchsmaller than the impedance formed by
and the two-wire.
Using the accurate transmission line equations, the effect of
the nonzero input impedance has been evaluated. It was foundthat over the frequency range of interest the accuracy of the ap-proximated value of
is within 90%, which is acceptable.
VI. M EASUREMENTS
The transimpedance ampliﬁer as depicted in Fig. 5 has
been built and tested. The transimpedance was measured to
be 99.6 dB
 and the bandwidth 1.1 MHz. Compensation
is realized by a
 of 1 pF. It should be noted that due to
component spread in
 and the parasitic capacitance of
 ,
the actual total compensation capacitance was approximately1.6 pF. This was accounted for in the calculation of
in
Fig. 6.
Generating an EM plane wave of 30 V/m and to make also
sure that just this plane wave is picked up by the transimpedanceampliﬁer, may be a tedious task. As shown in Section III, the dis-turbance current is dominated by a capacitance and the electricﬁeld component. Therefore, it was chosen to capacitively couplethe disturbing signal to the ampliﬁer. Besides, simulating ﬁeldto wire coupling by coupling an equivalent signal via a conduc-tance to the ampliﬁer, is a valid and generally used method for
frequencies at which transmission line effects are minimal [23].
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. V AN DER HORST et al. : SYSTEMATIC DESIGN OF A TIA WITH SPECIFIED ELECTROMAGNETIC OUT-OF-BAND INTERFERENCE BEHA VIOR 537
Fig. 6. Amplitude of the equivalent envelope detection source at the input of
the ampliﬁer as a function of frequency. The line is calculated. The crosses are
actual measurements. The ampliﬁer is frequency compensated to obtain a But-
terworth characteristic. Note that the out-of-band measurements of interest are
located above 1 MHz. The in-band detection components are only shown for
completeness.
The electric ﬁeld component has been replaced by a voltage
from a signal generator and the capacitance by a coupling ca-pacitor equal to the capacitance of the, removed, two-wire. Thevoltage was chosen such that at 1 MHz
amounted to the re-
quired 567 nA. Due to the differentiating character of the cou-pling capacitance
will increase with increasing frequency.
The measured and calculated values of
 are shown in
Fig. 6. The measured values are in close agreement with thecalculations and, as expected, no overshoot appears both in cal-culation and in measurement. Note that the out-of-band mea-surements of interest are located above 1 MHz. The in-band de-tection components are only shown for completeness.
The calculated equivalent current
ﬂattens out at a max-
imum value of approximately 428 pA. This is close to the ap-proximated value of 450 pA.
VII. D
ISCUSSION
This ampliﬁer was designed to meet a certain SER speciﬁca-
tion for interfering ﬁelds up to 100 MHz. That does not implythat there are no other design solutions and not even that this isthe best one possible. It can, e.g., be expected that both noiseand EMI requirements can be met by a (CMOS) FET imple-mentation of the ampliﬁer also. Probably, however, a more com-plicated, multistage solution will be required to meet the band-width speciﬁcation due to the often too low LP of a single stageFET (cascode) implementation.
Here, we have chosen to demonstrate that with enough loop
gain severe EMI requirements can be met with a BJT cascode,that is stronger nonlinear than a FET (cascode).
Extending the speciﬁcation for the interference from 100
MHz to 1 GHz or higher, two extra effects have to be taken intoaccount in the design process. First, transmission line theoryshows resonances in
at frequencies higher than 1 GHz.
Second,
 and
 (in series with
 ) will
introduce a nondominant pole in
 at approximately 1.4
GHz. Its effect on the disturbance is that of a ﬁrst-order low-passﬁlter. High-frequency maxima will thus be attenuated, leavingthe maximum at ca. 340 MHz as the EMI determining valueof
. A new, higher value, of
 , and hence,
 , willbe needed. It could be that now our simple cascode ampliﬁer
can not meet the speciﬁcations and a different implementationis required.
VIII. C
ONCLUSION
In this paper, a systematic method to design a transimpedance
ampliﬁer with speciﬁed EMI behavior has been presented. It
makes use of a simple method to approximate the amount of
disturbing signal at the input of a negative-feedback ampliﬁerdue to an interfering EM plane wave, and also of a modiﬁed hy-brid-
model that can be used for calculation of both linear and
second-order transfers of a bipolar junction transistor cascode.
Using the design method, the required transconductance to
reach the speciﬁcations can be calculated, from which the bi-asing of the cascode follows.
The transimpedance ampliﬁer has been designed to have a
transimpedance of 100 k
, a bandwidth of 1 MHz, and a min-
imal signal-to-error ratio of 70 dB, resulting from both noise andinterference, while being subjected to a plane wave of 30 V/m.
The transimpedance ampliﬁer has been built. Measurements
are in good agreement with calculations and simulations, andthus, support the method presented in this paper.
R
EFERENCES
[1] J. J. Goedbloed, “Kluwer technische boeken,” in Elektromagnetische
Compatibiliteit , 3rd ed. Englewood Cliffs, NJ: Prentice Hall, 1993.
[2] D. D. Weiner and J. F. Spina , Sinusoidal Analysis and Modeling of
Weakly Nonlinear Circuits, With Applications to Nonlinear Effects .
New York: Van Nostrand/Reinhold, 1980.
[3] E. K. de Lange, A. van Staveren, O. De Feo, F. L. Neerhoff, M. Hasler,
and J. R. Long, “Predicting nonlinear distortion in common-emitter
stages for ampliﬁer design using volterra series,” in Proc. NDES , 2002,
pp. 41–44.
[4] R. van Langevelde and F. M. Klaassen, “Effect of gate-ﬁeld dependent
mobility degradation on distortion analysis in mosfets,” IEEE Trans.
Electron Devices , vol. 44, no. 11, pp. 2044–2052, Nov. 1997.
[5] R. van Langevelde and F. M. Klaassen, “Accurate drain conductance
modeling for distortion analysis in mosfets,” in Proc. Int. Electron De-
vices Meet. , 1997, pp. 313–316.
[6] W. Sansen, “Distortion in elementary transistor circuits,” IEEE Trans.
Circuits Syst. II, Analog Digit. Signal Process. , vol. 46, no. 3, pp.
315–325, Mar. 1999.
[7] P. Wambacq, G. G. E. Gielen, P. R. Kinget, and W. Sansen, “High-fre-
quency distortion analysis of analog integrated circuits,” IEEE Trans.
Circuits Syst. II, Analog Digit. Signal Process. , vol. 46, no. 3, pp.
335–345, Mar. 1999.
[8] F. Fiori and P. S. Crovetti, “Nonlinear effects of radio-frequency
interference in operational ampliﬁers,” IEEE Trans. Circuits Syst. I,
Fundam. Theory Appl. , vol. 49, no. 3, pp. 367–372, Mar. 2002.
[9] S. Grafﬁ, G. Masetti, and D. Golzio, “New macromodels and measure-
ments for the analysis of EMI effects in 741 op-amp circuits,” IEEE
Trans. Electomagn. Compat. , vol. 33, no. 1, pp. 25–33, Feb. 1991.
[10] E. D. Totev and C. J. M. Verhoeven, “Design considerations for low-
ering sensitivity to out of band interference of negative-feedback am-pliﬁers,” in Proc. ISCAS , 2005, vol. 2, pp. 1597–1600.
[11] M. J. van der Horst, A. C. Linnenbank, and A. van Staveren, “Am-
plitude-modulation detection in single-stage negative-feedback ampli-
ﬁers due to interfering out-of-band signals,” IEEE Trans. Electromagn.
Compat. , vol. 47, no. 1, pp. 34–44, Feb. 2005.
[12] J. M. Redouté and M. Steyaert, “EMI resistant CMOS differential input
stages,” IEEE Trans. Circuits Syst. I, Reg. Papers , vol. 57, no. 2, pp.
323–331, Feb. 2010.
[13] A. Richelli, L. Colalongo, M. Quarantelli, and Z. M. Kovacs-Vajna,
“Robust design of low EMI susceptibility CMOS opamp,” IEEE Trans.
Electromagn. Compat. , vol. 46, no. 2, pp. 291–298, May 2004.
[14] Cenelec, Limits and methods of measurement of radio disturbance
characteristics of industrial, scientiﬁc and medical (ISM) radio-fre-
quency equipment Cenelec, Brussels, Belgium, NEN-EN 55011, 1992.
[15] “Medical Electrical Equipment, Part 1,” IEC 601-1-2, 1993.
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. 538 IEEE TRANSACTIONS ON CIRCUITS AND SYSTEMS—I: REGULAR PAPERS, VOL. 57, NO. 3, MARCH 2010
[16] “Radiofrequency interference with medical devices,” IEEE Eng. Med.
Biol. Mag. , vol. 17, no. 3, pp. 111–114, May/Jun. 1998, IEEE.
[17] P. S. Ruggera and E. R. O’Bryan, “Studies of apnea monitor radiofre-
quency electromagnetic interference,” in Proc. Annu. Int. Conf. IEEE
Eng. Med. Biol. Soc. , 1991, pp. 1641–1643.
[18] C. R. Paul , Introduction to Electromagnetic Compatibility , 1st ed.
New York: Wiley, 1992.
[19] A. A. Smith , Coupling of External Electromagnetic Fields to Transmis-
sion Lines , 1st ed. New York: Wiley, 1977.
[20] I. E. Getreu , Modelling the Bipolar Transistor , 1st ed. Amsterdam,
The Netherlands: Elsevier, 1978.
[21] P. R. Gray, P. J. Hurst, S. H. Lewis, and R. G. Meyer , Analysis and
Design of Analog Integrated Circuits , 4th ed. New York: Wiley, 2001.
[22] C. J. M. Verhoeven, A. van Staveren, G. L. E. Monna, M. H. L.
Kouwenhoven, and E. Yildiz , Structured Electronic Design, Nega-
tive-Feedback Ampliﬁers , 1st ed. Norwell, MA: Kluwer, 2003.
[23] K. Javor, “On ﬁeld-to-wire coupling versus conducted injection tech-
niques,” in Proc. IEEE Int. Symp. EMC , 1997, pp. 479–487.
Marcel J. van der Horst received the Ing. degree
in electrical engineering from the Hogeschool van
Amsterdam, Amsterdam, The Netherlands. He is
currently working toward the Ph.D. degree from
the Delft University of Technology, Delft, The
Netherlands.
From 1995 to 2008, he was a designer of biomed-
ical instrumentation at the Academic Medical
Center, Amsterdam. He is currently a Lecturer withthe Hogeschool van Amsterdam.
André C. Linnenbank (M’09) received the M.Sc.
degree in physics and the Ph.D. degree from the Uni-
versity of Amsterdam, Amsterdam, The Netherlands,
in 1989 and 1996, respectively.
From 1989 to 2000, he was with the Medical
Physics Department, Academic Medical Center,Amsterdam, where he has been he has been in the
Clinical and Experimental Cardiology Department
since 2000. His current research interests include
cardiac arrhythmia, multichannel ECG recordings,
medical imaging modalities, and signal and image
processing.
Wouter A. Serdijn (SM’08) was born in Zoeter-
meer, The Netherlands, in 1966. He received the
“ingenieurs” M.Sc. degree from the Faculty of Elec-trical Engineering, Delft University of Technology,
Delft, The Netherlands, in 1989, and the Ph.D.
degree from the Electronics Research Laboratory,
Delft University of Technology, in 1994.
He is currently with the Delft University of
Technology. He is a coeditor and coauthor of the
books Ultra Low-Power Biomedical Signal Pro-
cessing: An Analog Wavelet Filter Approach for
Pacemakers (Springer, 2009), Circuits and Systems for Future Generations of
Wireless Communications (Springer, 2009), Power Aware Architecting for Data
Dominated Applications (Springer, 2007), Adaptive Low-Power Circuits for
Wireless Communications (Springer, 2006), Research Perspectives on Dynamic
Translinear and Log-Domain Circuits (Kluwer, 2000), Dynamic Translinear
and Log-Domain Circuits (Kluwer, 1998), and Low-Voltage Low-Power Analog
Integrated Circuits (Kluwer, 1995). He has authored or coauthored six book
chapters, and more than 200 publications and presentations. He is engagedin teaching analog electronics, analog signal processing, micropower analog
IC design, and electronic design techniques. His current research interests
include low-voltage, ultralow-power, high-frequency, and dynamic-translinear
analog ICs along with circuits for RF and ultra-wideband (UWB) wireless
communications, cochlear implants, portable, wearable, implantable, and
injectable ExG recorders and pacemakers.
Dr. Serdijn is a mentor of the IEEE. He has received the EE Best
Teacher Award in 2001 and 2004. He was an Associate Editor for the
IEEE T
RANSACTIONS ON CIRCUITS AND SYSTEMS —I: R EGULAR PAPERS
(2004–2005) and the IEEE T RANSACTIONS ON CIRCUITS AND SYSTEMS —II:
EXPRESS BRIEFS (2002–2003 and 2006–2007), a Tutorial Session Cochair for
the IEEE International Symposium on Circuits and Systems (ISCAS) 2003, a
Analog Signal Processing Track Cochair for ISCAS 2004 and ISCAS 2005,
the Chair of the Analog Signal Processing Technical Committee of the IEEE
Circuits and Systems (CAS) Society, an Analog Signal Processing TrackCochair for the International Conference on Environmental and Computer
Science (ICECS) 2004, a member of the Technical Program Committee for the
2004 International Workshop on Biomedical Circuits and Systems, a member
of the International Program Committee for the International Association of
Science and Technology for Development International Conference on Circuits,
Signals, and Systems (IASTED CSS) 2005, and CSS 2006, a member of the
Technical Program Committee for the Asia Paciﬁc Conference on Circuits andSystems (APCCAS) 2006, a member of the Technical Program Committee
for the IEEE Biomedical Circuits and Systems Conference (BioCAS 2006,
BioCAS 2007, and BioCAS 2008), a Special-Session Co-Chair for ISCAS
2007, a member of the CAS Long-Term Strategy Committee. He is currently a
member of the Board of Governors (BoG) of the Circuits and Systems Society
(second term), a member of the Conference Division of the CAS BoG, a Deputy
Editor-in-Chief of theIEEE T
RANSACTIONS ON CIRCUITS AND SYSTEMS —I:
REGULAR PAPERS , and a member of the International Program Committee of
the 2009 International Conference on Biomedical Electronics and Devices, aSpecial Session Cochair for ISCAS 2009, a Special Session Cochair for ICECS
2009, and a member of the Technical Program Committee for ICUWB 2009.
Recently, he was elected as the Technical Program Chair for the ISCAS 2010.
He is currently the Editor-in-Chief of IEEE T
RANSACTIONS ON CIRCUITS AND
SYSTEMS —I: R EGULAR PAPERS .
John R. Long (M’95) received the B.Sc. degree in
electrical engineering from the University of Calgary,
Calgary, AB, Canada, in 1984, and the M.Eng. and
Ph.D. degrees in electronics from Carleton Univer-
sity, Ottawa, ON, Canada, in 1992 and 1996, respec-tively.
For ten years, he was at Bell-Northern Research,
Ottawa (now Nortel Networks R&D), where he was
involved in the design of application-speciﬁed inte-
grated circuits (ASICs) for Gbit/s ﬁber-optic trans-
mission systems,. From 1996 to 2001, he was an As-
sistant and then an Associate Professor at the University of Toronto, Canada.Since January 2002, he has been the Chair of the Electronics Research Lab-
oratory, Delft University of Technology, Delft, The Netherlands. His current
research interests include transceiver circuits for integrated wireless and high-
speed wireline data communications systems.
Prof. Long is a former Associate Editor of the IEEE J
OURNAL OF
SOLID -STATE CIRCUITS , and is currently a Distinguished Lecturer with the
Solid-State Circuits Society. He received the Natural Sciences and Engineering
Research Council (NSERC) Doctoral Prize and Douglas R. Colton and Gov-
ernor General’s Medals for research excellence, and is a corecipient of the BestPaper Awards from the International Solid-State Circuits Conference (ISSCC)
in 2000 and 2007, the RFIC and the European Wireless Symposia in 2006, and
IEEE-BCTM in 2003. He was the General Chair and a Local Organizer for the
2006 IEEE Bipolar/BiCMOS Circuits and Technology Meeting (BCTM), held
in Maastricht, NL. He chairs the RF circuits subcommittee for ISSCC 2010, and
is a member of the technical program committees for the European Solid-State
Circuits (ESSCIRC) and European Microwave IC (EuMIC) conferences.
Authorized licensed use limited to: IEEE Editors in Chief. Downloaded on May 10,2010 at 09:05:40 UTC from IEEE Xplore.  Restrictions apply. 